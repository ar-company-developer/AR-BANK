<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Фінанси та Баланс</title>
    
    <script type="module" src="https://www.gstatic.com/firebasejs/11.10.0/firebase-app.js"></script>
    <script type="module" src="https://www.gstatic.com/firebasejs/11.10.0/firebase-database.js"></script>
    <script type="module" src="https://www.gstatic.com/firebasejs/11.10.0/firebase-auth.js"></script>
    
    <style>
:root {
    --primary-color: #000000; /* ДОДАНО КРАПКУ З КОМОЮ */
    --background-color: #f7f9fc;
    --card-background: #ffffff; 
    --text-color: #333333;
    --light-text: #6c757d;
    --shadow-light: 0 4px 15px rgba(0, 0, 0, 0.05);
    --shadow-hover: 0 8px 25px rgba(0, 0, 0, 0.1);
    --border-color: #eeeeee;
    --balance-shadow: 0 10px 16px rgba(79, 70, 229, 0.4); 
    --balance-bg: linear-gradient(135deg, white, white); 
    
    --icon-fill-color: var(--primary-color);
    --icon-stroke-color: var(--primary-color); 
}
        .dark-mode {
            --primary-color: white;
            --background-color: #121212; 
            --card-background: #1e1e1e; 
            --text-color: #f0f0f0; /* Світлий текст */
            --light-text: #aaaaaa; /* Сірий текст у темному режимі */
            --shadow-light: 0 4px 10px rgba(0, 0, 0, 0.4);
            --shadow-hover: 0 8px 20px rgba(0, 0, 0, 0.6);
            --border-color: #333333; /* Темні лінії розділення */
            --balance-shadow: 0 10px 16px rgba(46, 134, 222, 0.4); 
            --balance-bg: linear-gradient(135deg, #2a2a2a, #1e1e1e); 
            --icon-fill-color: #f0f0f0;
            --icon-stroke-color: #f0f0f0;
        }
        body {
            font-family: 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background-color: var(--background-color);
            margin: 0;
            padding: 20px;
            color: var(--text-color); 
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            transition: background-color 0.3s, color 0.3s;
        }
        .container {
            width: 100%;
            max-width: 600px;
        }
        #mainDashboard {
            width: 100%;
        }
        #statusMessage {
            color: var(--text-color);
        }
        .back-button { 
            display: inline-flex;
            align-items: center;
            padding: 5px 0;
            margin-bottom: 10px;
            text-decoration: none;
            color: var(--primary-color);
            font-weight: 500;
            transition: color 0.2s;
        }

        .back-button:hover {
            color: gray; 
        }

        .back-button svg {
            width: 20px;
            height: 20px;
            margin-right: 8px;
            fill: var(--primary-color);
        }


        /* --- КАРТКА БАЛАНСУ --- */
        .balance-card {
            background: var(--balance-bg); 
            color: var(--text-color); /* Змінюємо, щоб текст був видимим у темному режимі */
            padding: 25px;
            border-radius: 20px; 
            margin-bottom: 30px;
            box-shadow: var(--balance-shadow); 
            text-align: center;
            font-size: 10px;
            transition: transform 0.3s;
            margin-top:20px;
        }

        /* ... стилі balance-card:hover, balance-title, balance-amount, currency ... */

        /* --- СТИЛІ ОПЕРАЦІЙ --- */
        .operations-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 15px;
        }

        .operation-button {
            background-color: var(--card-background);
            border: 1px solid var(--border-color); /* Використовуємо змінну */
            padding: 20px;
            border-radius: 12px;
            text-decoration: none;
            color: var(--text-color);
            font-weight: 600;
            font-size: 14px; 
            height: 110px; 
            
            display: flex;
            flex-direction: column; 
            justify-content: center; 
            align-items: center; 

            box-shadow: var(--shadow-light);
            transition: transform 0.2s, box-shadow 0.2s, border-color 0.2s;
        }

        .operation-button:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-hover);
            border-color: var(--primary-color);
        }

        /* !!!!!!! КЛЮЧОВИЙ СТИЛЬ ДЛЯ SVG ІКОНОК !!!!!!! */
        .operation-button svg {
            width: 32px; 
            height: 32px;
            margin-bottom: 5px; 
            
            /* Встановлюємо властивість 'color'. SVG з fill="currentColor"
               або stroke="currentColor" успадкує цей колір. */
            color: var(--icon-fill-color);
            
            transition: color 0.3s; 
        }

        /* Стиль для контурної іконки "Кредит" */
        .operation-button svg.credit-icon path {
             /* Якщо потрібно, щоб контурна іконка використовувала іншу змінну */
             stroke: var(--icon-stroke-color);
             fill: none;
             transition: stroke 0.3s; 
        }

        .balance-card:hover {
            transform: translateY(-3px);
        }

        .balance-title {
            font-size: 16px;
            opacity: 0.9;
            margin-bottom: 10px;
            font-weight: 400;
        }

        .balance-amount {
            font-size: 52px;
            font-weight: 700;
            line-height: 1.1;
            min-height: 55px;
        }

        .currency {
            font-size: 28px;
            font-weight: 500;
            margin-left: 8px;
        }
        
        /* Залишки ваших стилів */
        .inshe-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 15px;
        }

        .inshe-button {
            background-color: var(--card-background);
            border: 1px solid var(--border-color);
            padding: 5px;
            border-radius: 12px;
            text-decoration: none;
            color: var(--text-color);
            font-weight: 600;
            font-size: 14px; 
            height: 80px; 
            width: 340px;
            display: flex;
            flex-direction: column; 
            justify-content: center; 
            align-items: center; 
            margin-top: 10px;

            box-shadow: var(--shadow-light);
            transition: transform 0.2s, box-shadow 0.2s, border-color 0.2s;
        }

        .inshe-button:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-hover);
            border-color: var(--primary-color);
        }

        .inshe-button svg {
            width: 32px; 
            height: 32px;
            margin-bottom: 5px; 
            /* Використовуємо color для inshe-button також */
            color: var(--icon-fill-color); 
            transition: color 0.3s;
        }

        .inshe-button svg path {
             /* Стиль для іконки "Інше", якщо вона контурна */
             stroke: currentColor; 
             fill: none;
        }
        
        .history-section {
            margin-top: 30px;
        }

        .history-section h3 {
            font-size: 18px;
            color: var(--text-color);
            margin-bottom: 15px;
            font-weight: 600;
        }

        .history-list {
            list-style: none;
            padding: 0;
            margin: 0;
            background-color: var(--card-background);
            border-radius: 12px;
            box-shadow: var(--shadow-light);
        }

        .history-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .history-item:last-child {
            border-bottom: none;
        }

        .transaction-details {
            display: flex;
            flex-direction: column;
            text-align: left;
        }

        .transaction-title {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 2px;
        }

        .transaction-date {
            font-size: 12px;
            color: var(--light-text);
        }

        .transaction-amount {
            font-size: 16px;
            font-weight: 700;
        }

        .amount-positive {
            color: #28a745;
        }

        .amount-negative {
            color: #dc3545;
        }
                .inshe-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 15px;
        }

        .inshe-button {
            background-color: var(--card-background);
            border: 1px solid var(--border-color);
            padding: 5px;
            border-radius: 12px;
            text-decoration: none;
            color: var(--text-color);
            font-weight: 600;
            font-size: 14px; 
            height: 80px; 
            width: 340px;
            display: flex;
            flex-direction: column; 
            justify-content: center; 
            align-items: center; 
            margin-top: 10px;

            box-shadow: var(--shadow-light);
            transition: transform 0.2s, box-shadow 0.2s, border-color 0.2s;
        }

        .inshe-button:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-hover);
            border-color: var(--primary-color);
        }

        .inshe-button svg {
            width: 32px; 
            height: 32px;
            margin-bottom: 5px; 
            /* Використовуємо color для inshe-button також */
            color: var(--icon-fill-color); 
            transition: color 0.3s;
        }

        .inshe-button svg path {
             /* Стиль для іконки "Інше", якщо вона контурна */
             stroke: currentColor; 
             fill: none;
        }
    </style>

</head>
<body>

    <div class="container">
        <div id="statusMessage" style="text-align: center; margin-top: 50px;"></div>
        
        <div id="mainDashboard" style="display:none;">
            <a href="card.html" class="back-button">
                <svg viewBox="0 0 24 24"><path fill="currentColor" d="M15.41 7.41L14 6L8 12L14 18L15.41 16.59L10.83 12L15.41 7.41Z"/></svg>
                <span data-i18n="back">Назад</span>
            </a>

            <div class="balance-card">
                <div class="balance-title" data-i18n="finance_earned_title">Зароблено:</div>
                <div class="balance-amount" id="userBalance" data-i18n="load">0</div>
            </div>
            
            <div class="operations-grid">
                <a href="vklad.html" class="operation-button">
                   <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 492 492" style="enable-background:new 0 0 492 492" xml:space="preserve"><path style="fill-rule:evenodd;clip-rule:evenodd;fill:currentColor" d="M186.416 238.46a5.922 5.922 0 0 1-5.184-3.048c-1.584-2.856-.552-6.48 2.304-8.064 10.848-6.048 29.856-9.648 50.808-9.648 18.84 0 36.12 2.904 47.4 7.944 3 1.344 4.32 4.848 3 7.824-1.344 3-4.848 4.32-7.824 3-9.672-4.32-25.584-6.912-42.552-6.912-18.744 0-36.024 3.12-45.072 8.16a5.99 5.99 0 0 1-2.88.744z"/><path style="fill-rule:evenodd;clip-rule:evenodd;fill:currentColor" d="M339.104 431.06h-51.84c-3.264 0-5.928-2.664-5.928-5.928v-19.968c-18.288 4.44-33.192 6.216-51.144 6.216-16.68 0-33.024-1.8-48.696-5.352v19.104c0 3.264-2.664 5.928-5.928 5.928h-51.84c-3.264 0-5.928-2.664-5.928-5.928v-58.104c-7.224-8.04-13.176-16.8-17.688-26.112l-18.048-2.856c-5.448-.864-10.44-3.648-14.016-7.848s-5.568-9.552-5.568-15.072v-28.944c0-5.52 1.968-10.872 5.568-15.096a23.202 23.202 0 0 1 14.016-7.848l14.448-2.28c5.256-13.704 13.416-26.328 24.288-37.584 1.968-13.008 1.032-30.408-7.248-42.264a5.949 5.949 0 0 1-.768-5.304 5.932 5.932 0 0 1 3.816-3.744c.36-.12 8.952-2.784 20.208-1.344 9.696 1.248 23.232 5.856 34.488 20.304 16.896-4.248 35.76-6.216 58.896-6.216 23.088 0 44.232 3.072 62.856 9.12 19.824 6.432 36.264 16.104 48.84 28.704a94.526 94.526 0 0 1 21.144 32.16c4.992 12.624 7.536 26.76 7.512 42.024-.024 24.384-8.856 47.64-25.536 67.416v60.912c.024 3.24-2.616 5.904-5.904 5.904zm-45.912-11.856h39.984v-57.192c0-1.44.528-2.832 1.464-3.912 15.72-17.928 24.024-39.12 24.048-61.32.024-26.88-8.448-49.032-25.176-65.784-11.256-11.28-26.112-19.944-44.112-25.8-17.448-5.664-37.368-8.544-59.208-8.544-23.88 0-42.864 2.184-59.712 6.84a5.941 5.941 0 0 1-6.48-2.376c-7.296-10.728-16.8-16.968-28.224-18.576a42.731 42.731 0 0 0-8.016-.336c8.208 17.952 5.568 38.472 4.416 45a5.947 5.947 0 0 1-1.632 3.144c-11.184 11.256-19.272 23.976-24.048 37.848a6.006 6.006 0 0 1-4.68 3.936l-17.88 2.832c-5.544.888-9.576 5.592-9.576 11.232v28.944c0 5.64 4.032 10.344 9.576 11.232l21.144 3.336a5.954 5.954 0 0 1 4.488 3.432c4.44 9.888 10.656 19.152 18.504 27.552a5.903 5.903 0 0 1 1.584 4.056v54.48h39.984v-20.736c0-1.848.864-3.576 2.304-4.704a5.892 5.892 0 0 1 5.136-1.032c16.92 4.512 34.8 6.792 53.088 6.792 19.2 0 34.776-2.16 55.536-7.704a5.892 5.892 0 0 1 5.136 1.032 5.934 5.934 0 0 1 2.328 4.704v21.624h.024zM100.904 266.276z"/><path style="fill-rule:evenodd;clip-rule:evenodd;fill:currentColor" d="M156.297 262.868c0-6.16-4.42-11.184-9.84-11.184s-9.84 5.024-9.84 11.184c0 6.16 4.42 11.184 9.84 11.184s9.84-5.024 9.84-11.184zM366.344 318.668c-1.392 0-2.76-.12-4.128-.384-3.216-.6-5.328-3.696-4.728-6.912.6-3.216 3.696-5.328 6.912-4.728 3.624.672 9.24-.552 13.224-6.264.264-.36.6-.912 1.032-1.536 3.576-5.496 11.016-16.968 22.608-19.152 6.096-1.152 12.192.408 18.144 4.68 8.952 6.408 10.416 17.616 10.608 19.8.288 3.264-2.112 6.144-5.376 6.432-3.264.288-6.144-2.112-6.432-5.376-.024-.312-.744-7.704-5.688-11.232-3.264-2.328-6.216-3.192-9.048-2.664-6.624 1.248-12.192 9.84-14.856 13.968-.456.72-.864 1.344-1.224 1.872-5.112 7.248-13.032 11.496-21.048 11.496z"/><g><path style="fill-rule:evenodd;clip-rule:evenodd;fill:currentColor" d="M238.52 174.02c-14.856 0-28.824-5.808-39.312-16.344-10.488-10.536-16.272-24.552-16.272-39.456s5.784-28.92 16.272-39.456C209.72 68.228 223.664 62.42 238.52 62.42c14.856 0 28.824 5.808 39.312 16.344 10.488 10.536 16.272 24.552 16.272 39.456s-5.784 28.92-16.272 39.456c-10.512 10.536-24.456 16.344-39.312 16.344zm0-99.744c-24.12 0-43.728 19.704-43.728 43.944 0 24.24 19.608 43.944 43.728 43.944s43.728-19.704 43.728-43.944c0-24.24-19.632-43.944-43.728-43.944z"/><path style="fill-rule:evenodd;clip-rule:evenodd;currentColor" d="M238.52 148.076c-8.976 0-16.824-5.472-19.104-13.296a5.922 5.922 0 0 1 4.032-7.344 5.922 5.922 0 0 1 7.344 4.032c.696 2.376 3.576 4.776 7.728 4.776 4.296 0 7.92-2.76 7.92-6.048 0-1.032-.288-1.944-1.728-3.048-1.608-1.224-4.152-2.304-7.584-3.168-11.688-2.712-18.384-9.168-18.384-17.736 0-9.864 8.856-17.904 19.776-17.904 8.904 0 16.728 5.424 19.08 13.176a5.952 5.952 0 0 1-3.96 7.392 5.952 5.952 0 0 1-7.392-3.96c-.816-2.736-4.08-4.728-7.728-4.728-4.296 0-7.92 2.76-7.92 6.048 0 .96.672 4.2 9.24 6.192.024 0 .072.024.096.024 5.112 1.272 9.024 3 11.976 5.28 4.152 3.192 6.336 7.488 6.336 12.432.024 9.864-8.832 17.88-19.728 17.88z"/><path style="fill-rule:evenodd;clip-rule:evenodd;fill:currentColor" d="M238.52 155.18c-3.264 0-5.928-2.664-5.928-5.928V87.188c0-3.264 2.664-5.928 5.928-5.928s5.928 2.664 5.928 5.928v62.064a5.925 5.925 0 0 1-5.928 5.928z"/></g></svg>
                    <span data-i18n="finance_btn_deposit">Банківський вклад</span>
                </a>
                
                <a href="tasks.html" class="operation-button">
<svg width="800px" height="800px" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M4 5.25C4 3.45508 5.45507 2 7.25 2H20.75C22.5449 2 24 3.45507 24 5.25V17.3787C23.8796 17.4592 23.7653 17.5527 23.659 17.659L22.5 18.818V5.25C22.5 4.2835 21.7165 3.5 20.75 3.5H7.25C6.2835 3.5 5.5 4.2835 5.5 5.25V22.7497C5.5 23.7162 6.2835 24.4997 7.25 24.4997H15.3177L16.8177 25.9997H7.25C5.45507 25.9997 4 24.5446 4 22.7497V5.25Z" fill="currentColor"/>
<path d="M10.5 8.75C10.5 9.44036 9.94036 10 9.25 10C8.55964 10 8 9.44036 8 8.75C8 8.05964 8.55964 7.5 9.25 7.5C9.94036 7.5 10.5 8.05964 10.5 8.75Z" fill="currentColor"/>
<path d="M9.25 15.2498C9.94036 15.2498 10.5 14.6902 10.5 13.9998C10.5 13.3095 9.94036 12.7498 9.25 12.7498C8.55964 12.7498 8 13.3095 8 13.9998C8 14.6902 8.55964 15.2498 9.25 15.2498Z" fill="currentColor"/>
<path d="M9.25 20.5C9.94036 20.5 10.5 19.9404 10.5 19.25C10.5 18.5596 9.94036 18 9.25 18C8.55964 18 8 18.5596 8 19.25C8 19.9404 8.55964 20.5 9.25 20.5Z" fill="currentColor"/>
<path d="M12.75 8C12.3358 8 12 8.33579 12 8.75C12 9.16421 12.3358 9.5 12.75 9.5H19.25C19.6642 9.5 20 9.16421 20 8.75C20 8.33579 19.6642 8 19.25 8H12.75Z" fill="currentColor"/>
<path d="M12 13.9998C12 13.5856 12.3358 13.2498 12.75 13.2498H19.25C19.6642 13.2498 20 13.5856 20 13.9998C20 14.414 19.6642 14.7498 19.25 14.7498H12.75C12.3358 14.7498 12 14.414 12 13.9998Z" fill="currentColor"/>
<path d="M12.75 18.5C12.3358 18.5 12 18.8358 12 19.25C12 19.6642 12.3358 20 12.75 20H19.25C19.6642 20 20 19.6642 20 19.25C20 18.8358 19.6642 18.5 19.25 18.5H12.75Z" fill="currentColor"/>
<path d="M25.7803 19.7803L19.7803 25.7803C19.6397 25.921 19.4489 26 19.25 26C19.0511 26 18.8603 25.921 18.7197 25.7803L15.7216 22.7823C15.4287 22.4894 15.4287 22.0145 15.7216 21.7216C16.0145 21.4287 16.4894 21.4287 16.7823 21.7216L19.25 24.1893L24.7197 18.7197C25.0126 18.4268 25.4874 18.4268 25.7803 18.7197C26.0732 19.0126 26.0732 19.4874 25.7803 19.7803Z" fill="currentColor"/>
</svg>
                    <span data-i18n="finance_btn_tasks">Завдання</span>
                </a>
            </div>
        </div>
    </div>

    <script src="translate.js"></script>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.10.0/firebase-app.js";
        import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/11.10.0/firebase-database.js";
        import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.10.0/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCxfUZl7STcdC53SSogfbVc-4dIijVEbLg",
            authDomain: "ar-bank-dbfd9.firebaseapp.com",
            databaseURL: "https://ar-bank-dbfd9-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "ar-bank-dbfd9"
        };
        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);
        const auth = getAuth(app); 

        const mainDashboard = document.getElementById('mainDashboard');
        const statusMessage = document.getElementById('statusMessage');
        const balanceElement = document.getElementById('userBalance');

        if (localStorage.getItem('theme') === 'dark') document.documentElement.classList.add('dark-mode');

        onAuthStateChanged(auth, (user) => {
            if (user) {
                statusMessage.style.display = 'none';
                mainDashboard.style.display = 'block';
                listenForBalance(user.uid);
            } else {
                const t = translations[localStorage.getItem('user_lang') || 'uk'];
                statusMessage.innerHTML = t.auth_not_logged_in.replace('{login_link}', `<a href="login.html">${t.auth_login_link}</a>`);
            }
        });

        function listenForBalance(uid) {
            onValue(ref(database, `earning/${uid}`), (snap) => {
                const data = snap.val();
                if (data && data.balance !== undefined) {
                    balanceElement.innerHTML = `${Number(data.balance).toLocaleString('uk-UA')} <span class="currency">€</span>`;
                } else {
                    balanceElement.innerHTML = `0 <span class="currency">€</span>`;
                }
            });
        }
    </script>
</body>
</html>
